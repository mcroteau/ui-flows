<html>
	<head>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.0/jquery.min.js"></script>
		<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.13/jquery-ui.min.js"></script>
		<script type="text/javascript" src="_js/jquery.jsPlumb-1.3.3-all-min.js"></script>
		<script type="text/javascript" src="_js/jsBezier-0.2-min.js"></script>		
		<style>
			*{padding:0;margin:0;}
			body{font:normal 12px/1.2 Arial}
			.action{width:300px;border:1px solid #cccccc;}
			.action span{display:block;height:15px;background:#f1f1f1;}
			.action p{border-bottom:2px solid #cccccc;margin:10px;padding-bottom:5px;}
			.action ul{margin:10px;list-style:none;}
			.action ul li{border-bottom:1px dashed #cccccc;padding-bottom:5px;margin-bottom:5px;}
			.action ul li:last-child{border:none;padding-bottom:0px;}
		</style>
	</head>
	<title></title>
	<body>
	
		<div id="stories">
			
			<div class="action">
				<span></span>
				<p contenteditable="true">What the user sees</p>
				<ul>
					<li contenteditable="true">What the user does</li>
					<li contenteditable="true">What the user does</li>
					<li contenteditable="true">What the user does</li>
				</ul>
				<a class="newChoice" href="#">New Choice</a>
			</div>
		
		</div>
		
		
		
		
		<script>
		
		function getEventTarget(e){
			var e=e || window.event;
			return e.target || e.srcElement;
		}
		
		
		$('a.newChoice').bind('click',function(e){
			e.preventDefault()
			var target=getEventTarget(e);
			if(target && target.nodeName.toLowerCase() === "a"){
				$(target).prev('ul').append("<li contenteditable=\"true\">New User Action</li>")
			}
			
		})
		
		
		$('[contenteditable]').live('focus', function() {
		    var $this = $(this);
		    $this.data('before', $this.html());
		}).live('blur', function() {
		    var $this = $(this);
		    if($this.data('before') === $this.html()){
		    	console.info('there has not been a change')
		    }
		    if($this.html().length <= 4){
		    	$this.remove()
		    }
		    /*
		    if ($this.data('before') !== $this.html()) {
		        $this.data('before', $this.html());
		        $this.trigger('change');
		    }
		    */
		    
		});
		
			
	</script>

		
		
		
	</body>
</html>